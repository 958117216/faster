<launch>

	<arg name="quadrotor"/>
	<arg name="filter"/>
	<arg name="bag"/>

	<node ns="$(arg quadrotor)" name="reactive_planner" pkg="acl_planning" type="reactive_planner" output="screen" clear_params="true">

		<rosparam file="$(find acl_planning)/param/react.yaml" command="load"/>

		<remap from="~vicon" to="state_estimate"/>
		<remap from="~goal" to="goal" />
		<remap from="~event" to="event" />
		<remap from="~global_goal" to="global_goal" />


		<remap from="~clean_scan" to="clean_scan"/>
		<remap from="~new_global_goal" to="new_global_goal"/>
		<remap from="~int_goal" to="int_goal"/>	
		<remap from="~last_global_goal" to="last_global_goal"/>
		<remap unless="$(arg filter)" from="~scan" to="scan"/>	
		<remap if="$(arg filter)" from="~scan" to="filtered_scan"/>

	</node>

	<node if="$(arg filter)" ns="$(arg quadrotor)" name="scan_filter" pkg="acl_planning" type="gpf" output="screen" clear_params="true">

		<param name="ground_range" type="double" value="4"/>
		<param name="filter_thresh" type="double" value="0.1"/>

		<remap from="~vicon" to="state_estimate"/>
		<remap from="~scan" to="scan"/>
		<remap from="~filtered_scan" to="filtered_scan"/>	
	</node>

	<group if="$(arg bag)">
        <!-- Ensure RosBag is saving important data -->
        <node ns="$(arg quadrotor)" pkg="rosbag" type="record" name="rosbag_record" args="-o /media/odroid/LOGGER_USB/bags/$(arg quadrotor)PlannerLogFile scan global_goal int_goal new_global_goal clean_scan corridor_scan /tf"/>
    </group>

</launch>